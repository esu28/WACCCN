# Wavelet Filter Banks Used in WACCCN

This document summarizes the 2D wavelet filter banks and dual-tree complex wavelet transform (DTCWT) configuration used in the WACCCN pipeline.

---

## Notation and Conventions

- We denote the **analysis low-pass filter** as \(h_0\).
- We denote **analysis high-pass filters** as \(h_m\) for \(m = 1, \dots, M-1\).
- Filters are given as column vectors; rows list taps in increasing sample index order.
- All filters are orthogonal or biorthogonal filter banks drawn from standard constructions.

---

## 2-Band Filter Banks (Daubechies)

### 2-band 2-regular (db2) filter bank \[Daubechies, 1992\]

| Tap index | \(h_0\) (low-pass) | \(h_1\) (high-pass) |
|-----------|--------------------|----------------------|
| 0         |  0.482963          | -0.129410           |
| 1         |  0.836516          | -0.224144           |
| 2         |  0.224144          |  0.836516           |
| 3         | -0.129410          | -0.482963           |

---

### 2-band 3-regular (db3) filter bank \[Daubechies, 1992\]

| Tap index | \(h_0\) | \(h_1\) |
|-----------|---------|---------|
| 0         |  0.332671 |  0.035226 |
| 1         |  0.806892 |  0.085441 |
| 2         |  0.459878 | -0.135011 |
| 3         | -0.135011 | -0.459878 |
| 4         | -0.085441 |  0.806892 |
| 5         |  0.035226 | -0.332671 |

---

### 2-band 4-regular (db4) filter bank \[Daubechies, 1992\]

| Tap index | \(h_0\) | \(h_1\) |
|-----------|---------|---------|
| 0         |  0.230378 | -0.010597 |
| 1         |  0.714847 | -0.032883 |
| 2         |  0.630881 |  0.030841 |
| 3         | -0.027984 |  0.187035 |
| 4         | -0.187035 | -0.027984 |
| 5         |  0.030841 | -0.630881 |
| 6         |  0.032883 |  0.714847 |
| 7         | -0.010597 | -0.230378 |

---

## M-Band Filter Banks (Lin & Vaidyanathan)

All 3- and 4-band filters below are from Lin & Vaidyanathan (2006).

### 3-band 2-regular filter bank

| Tap index | \(h_0\)    | \(h_1\)    | \(h_2\)    |
|-----------|-----------:|-----------:|-----------:|
| 0         |  0.338386  |  0.530836  |  0.723286  |
| 1         |  0.238964  |  0.046514  | -0.145936  |
| 2         | -0.117377  |  0.544331  | -0.018706  |
| 3         | -0.699120  | -0.136083  |  0.426954  |
| 4         |  0.403637  | -0.628539  |  0.460605  |
| 5         | -0.403637  | -0.078567  |  0.246502  |

---

### 4-band 2-regular filter bank

| Tap index | \(h_0\)      | \(h_1\)      | \(h_2\)      | \(h_3\)      |
|-----------|-------------:|-------------:|-------------:|-------------:|
| 0         |  0.2697890   |  0.3947890   |  0.5197890   |  0.6647890   |
| 1         |  0.2302110   |  0.1052110   | -0.0197890   | -0.1447890   |
| 2         | -0.2825435   |  0.5553379   |  0.2385187   | -0.0783004   |
| 3         | -0.5834819   | -0.2666627   |  0.0501564   |  0.3669755   |
| 4         |  0.4125840   | -0.6279376   |  0.3727840   |  0.1487574   |
| 5         | -0.4125840   | -0.1885590   |  0.0354659   |  0.2594909   |
| 6         |  0.2382055   |  0.1088646   | -0.7275830   |  0.5572896   |
| 7         | -0.2382055   | -0.1088646   |  0.0204763   |  0.1498171   |

---

### 4-band 4-regular filter bank

| Tap index | \(h_0\)         | \(h_1\)          | \(h_2\)          | \(h_3\)          |
|-----------|----------------:|-----------------:|-----------------:|-----------------:|
| 0         |  0.0857130200   | -0.1045086525    |  0.2560950163    |  0.1839986022    |
| 1         |  0.1931394393   |  0.1183282069    | -0.2048089157    | -0.6622893130    |
| 2         |  0.3491805097   | -0.1011065044    | -0.2503433230    |  0.6880085746    |
| 3         |  0.5616494215   | -0.0115563891    | -0.2484277272    | -0.1379502447    |
| 4         |  0.4955029828   |  0.6005913823    |  0.4477496752    |  0.0446493766    |
| 5         |  0.4145647737   | -0.2550401616    |  0.0010274000    | -0.0823301969    |
| 6         |  0.2190308939   | -0.4264277361    | -0.0621881917    | -0.0923899104    |
| 7         | -0.1145361261   | -0.0827398180    |  0.5562313118    | -0.0233349758    |
| 8         | -0.0952930728   |  0.07222022649   | -0.2245618041    |  0.0290655661    |
| 9         | -0.1306948909   |  0.2684936992    | -0.3300536827    |  0.0702950474    |
| 10        | -0.0827496793   |  0.1691549718    | -0.2088643503    |  0.0443561794    |
| 11        |  0.0719795354   | -0.4437039320    |  0.2202951830    | -0.0918374833    |
| 12        |  0.0140770701   |  0.0849964877    |  0.0207171125    |  0.0128845052    |
| 13        |  0.0229906779   |  0.1388163056    |  0.0338351983    |  0.0210429802    |
| 14        |  0.0145382757   |  0.0877812188    |  0.0213958651    |  0.0133066389    |
| 15        | -0.0190928308   | -0.1152813433    | -0.0280987676    | -0.0174753464    |

---

## Level-1 Subband Orientations and Reliability

Angles are in degrees. Larger \(\kappa\) indicates a tighter dominant orientation around the listed angle. The LL (approximation) band is omitted.

### 2-band, 2-regular (wv22)

| Subband | \(\theta\)      | \(\kappa\) |
|---------|----------------:|----------:|
| \(B_{01}\) |  90.00°       | 0.691     |
| \(B_{10}\) |   0.00°       | 0.691     |
| \(B_{11}\) |   0.34°       | 0.000     |

---

### 2-band, 3-regular (wv23, Db3)

| Subband | \(\theta\)      | \(\kappa\) |
|---------|----------------:|----------:|
| \(B_{01}\) |  90.00°       | 0.710     |
| \(B_{10}\) | 180.00°       | 0.710     |
| \(B_{11}\) |   0.21°       | 0.000     |

---

### 2-band, 4-regular (wv24, Db4)

| Subband | \(\theta\)      | \(\kappa\) |
|---------|----------------:|----------:|
| \(B_{01}\) |  90.00°       | 0.720     |
| \(B_{10}\) |   0.00°       | 0.720     |
| \(B_{11}\) | 177.88°       | 0.000     |

---

### 3-band, 2-regular (wv32)

| Subband | \(\theta\)      | \(\kappa\) |
|---------|----------------:|----------:|
| \(B_{01}\) |  90.00°       | 0.696     |
| \(B_{02}\) |  90.00°       | 0.853     |
| \(B_{10}\) | 180.00°       | 0.696     |
| \(B_{11}\) | 177.77°       | 0.000     |
| \(B_{12}\) |  90.00°       | 0.374     |
| \(B_{20}\) |   0.00°       | 0.853     |
| \(B_{21}\) |   0.00°       | 0.374     |
| \(B_{22}\) | 179.80°       | 0.000     |

---

### 4-band, 2-regular (wv42)

| Subband | \(\theta\)      | \(\kappa\) |
|---------|----------------:|----------:|
| \(B_{01}\) |  90.00°       | 0.689     |
| \(B_{02}\) |  90.00°       | 0.841     |
| \(B_{03}\) |  90.00°       | 0.873     |
| \(B_{10}\) | 180.00°       | 0.689     |
| \(B_{11}\) | 178.86°       | 0.000     |
| \(B_{12}\) |  90.00°       | 0.409     |
| \(B_{13}\) |  90.00°       | 0.485     |
| \(B_{20}\) |   0.00°       | 0.841     |
| \(B_{21}\) |   0.00°       | 0.409     |
| \(B_{22}\) |  90.30°       | 0.000     |
| \(B_{23}\) |  90.00°       | 0.108     |
| \(B_{30}\) |   0.00°       | 0.873     |
| \(B_{31}\) |   0.00°       | 0.485     |
| \(B_{32}\) |   0.00°       | 0.108     |
| \(B_{33}\) |   0.54°       | 0.000     |

---

### 4-band, 4-regular (wv44)

| Subband | \(\theta\)      | \(\kappa\) |
|---------|----------------:|----------:|
| \(B_{01}\) |  90.00°       | 0.794     |
| \(B_{02}\) |  90.00°       | 0.781     |
| \(B_{03}\) |  90.00°       | 0.907     |
| \(B_{10}\) | 180.00°       | 0.794     |
| \(B_{11}\) |  89.80°       | 0.000     |
| \(B_{12}\) |   0.00°       | 0.014     |
| \(B_{13}\) |  90.00°       | 0.346     |
| \(B_{20}\) | 180.00°       | 0.781     |
| \(B_{21}\) |  90.00°       | 0.014     |
| \(B_{22}\) |  90.77°       | 0.000     |
| \(B_{23}\) |  90.00°       | 0.374     |
| \(B_{30}\) | 180.00°       | 0.907     |
| \(B_{31}\) | 180.00°       | 0.346     |
| \(B_{32}\) |   0.00°       | 0.374     |
| \(B_{33}\) |  50.75°       | 0.000     |

---

## Dual-Tree Complex Wavelet Transform (DTCWT) Configuration

We use the standard 2D DTCWT configuration as implemented in common toolboxes:

- **Level 1 filters:** Near-symmetric biorthogonal Hilbert-pair filters (`near_sym_a`), tap lengths \((5, 7)\).
- **Levels ≥ 2 filters:** Q-shift Hilbert-pair filters (`qshift_a`), tap lengths \((10, 10)\).

| Level(s) | Family (name)           | Tap lengths |
|----------|-------------------------|-------------|
| 1        | Near-symmetric biorthogonal (`near_sym_a`) | (5, 7)     |
| ≥ 2      | Q-shift Hilbert pair (`qshift_a`)          | (10, 10)   |

Each DTCWT level yields **six oriented complex high-pass subbands** with nominal orientations:

\[
\{15^\circ,\ 45^\circ,\ 75^\circ,\ 105^\circ,\ 135^\circ,\ 165^\circ\}.
\]

In code, we store these as:

```python
ANGLES_DEG = [15, 45, 75, 105, 135, 165]
